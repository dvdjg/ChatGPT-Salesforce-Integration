<template>
    <lightning-card title="IA Conversation" icon-name="standard:contact">
        <div class="slds-p-around_medium">
            <lightning-combobox name="Conversations" label="Conversations" placeholder="Choose Conversation"
                value={strConversation} onchange={handleChangeConversation} options={conversations}>
            </lightning-combobox>
        </div>
        <div class="slds-p-around_medium lgc-bg">
            <span onkeypress={keyCheckConversation}>
                <lightning-input type="text" label="Conversation" onchange={handleInputConversationChange}
                    value={strConversation}></lightning-input>
            </span>
        </div>

        <div class="slds-box slds-theme_default">
            <section role="log" class="slds-chat">
                <ul class="slds-chat-list">
                    <template for:each={conversation} for:item="message">
                        <li key={message.id} class={message.liClass}>
                            <div class="slds-chat-message">
                                <div class="slds-chat-message__body">
                                    <div class={message.messageClass}>
                                        <span>{message.role}: {message.text}</span>
                                    </div>
                                    <template lwc:if={message.meta}>
                                        <div class="slds-chat-message__meta" aria-label={message.metaLabel}>
                                            {message.meta}</div>
                                    </template>
                                </div>
                            </div>
                        </li>
                    </template>
                </ul>
            </section>
            <div class="slds-grid slds-grid_align-spread slds-p-top_medium">
                <div class="slds-col slds-size_10-of-12">
                    <span onkeypress={keyCheckMessage}>
                        <lightning-input type="text" label="Type your message" value={messageInput}
                            onchange={handleChange}></lightning-input>
                    </span>
                </div>
                <div class="slds-col slds-size_2-of-12 slds-text-align_right slds-align-middle slds-p-top_medium">
                    <lightning-button label="Send" onclick={handleSendMessage} variant="brand"></lightning-button>
                </div>
            </div>
        </div>
        <template lwc:if={error}>
            <div class="slds-var-m-vertical_small">
                <span class="slds-text-color_destructive">
                    {error}
                </span>
            </div>
        </template>
    </lightning-card>
</template>